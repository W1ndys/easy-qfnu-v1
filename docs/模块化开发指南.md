# Vue3 + UniApp æ¨¡å—åŒ–å¼€å‘æŒ‡å—

## ğŸ“‹ ç›®å½•

- [åŸºæœ¬åŸåˆ™](#åŸºæœ¬åŸåˆ™)
- [ç›®å½•ç»“æ„è§„èŒƒ](#ç›®å½•ç»“æ„è§„èŒƒ)
- [ç»„ä»¶æ‹†åˆ†ç­–ç•¥](#ç»„ä»¶æ‹†åˆ†ç­–ç•¥)
- [ç»„åˆå¼å‡½æ•°(Composables)è®¾è®¡](#ç»„åˆå¼å‡½æ•°è®¾è®¡)
- [æ ·å¼ç®¡ç†](#æ ·å¼ç®¡ç†)
- [å®æˆ˜ç¤ºä¾‹](#å®æˆ˜ç¤ºä¾‹)
- [å¼€å‘æµç¨‹](#å¼€å‘æµç¨‹)
- [å¸¸è§é™·é˜±](#å¸¸è§é™·é˜±)

## ğŸ¯ åŸºæœ¬åŸåˆ™

### 1. å•ä¸€èŒè´£åŸåˆ™ (SRP)

- æ¯ä¸ªæ–‡ä»¶åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šåŠŸèƒ½
- ä¸€ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹æƒ…
- ä¸€ä¸ªå‡½æ•°åªè§£å†³ä¸€ä¸ªé—®é¢˜

### 2. å¼€æ”¾å°é—­åŸåˆ™ (OCP)

- å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
- é€šè¿‡ props å’Œ events è¿›è¡Œé€šä¿¡
- ä½¿ç”¨æ’æ§½ (slots) æä¾›æ‰©å±•ç‚¹

### 3. ä¾èµ–å€’ç½®åŸåˆ™ (DIP)

- ä¾èµ–æŠ½è±¡è€Œéå…·ä½“å®ç°
- é€šè¿‡ç»„åˆå¼å‡½æ•°æŠ½è±¡ä¸šåŠ¡é€»è¾‘
- ç»„ä»¶åªå…³å¿ƒå¦‚ä½•å±•ç¤ºï¼Œä¸å…³å¿ƒæ•°æ®å¦‚ä½•è·å–

## ğŸ“ ç›®å½•ç»“æ„è§„èŒƒ

```
pages/
â””â”€â”€ your-page/
    â”œâ”€â”€ index.vue              # ä¸»é¡µé¢æ–‡ä»¶ï¼ˆå…¥å£ï¼‰
    â”œâ”€â”€ components/            # é¡µé¢ä¸“ç”¨ç»„ä»¶
    â”‚   â”œâ”€â”€ HeaderSection.vue
    â”‚   â”œâ”€â”€ ContentArea.vue
    â”‚   â””â”€â”€ FooterActions.vue
    â”œâ”€â”€ composables/           # ç»„åˆå¼å‡½æ•°
    â”‚   â”œâ”€â”€ usePageData.js
    â”‚   â”œâ”€â”€ useFormValidation.js
    â”‚   â””â”€â”€ useApiCalls.js
    â”œâ”€â”€ styles/                # æ ·å¼æ–‡ä»¶
    â”‚   â”œâ”€â”€ index.scss         # ä¸»æ ·å¼
    â”‚   â”œâ”€â”€ components.scss    # ç»„ä»¶æ ·å¼
    â”‚   â””â”€â”€ variables.scss     # å˜é‡å®šä¹‰
    â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
    â”‚   â”œâ”€â”€ formatters.js
    â”‚   â””â”€â”€ validators.js
    â””â”€â”€ types/                 # ç±»å‹å®šä¹‰(TypeScript)
        â””â”€â”€ index.ts
```

## ğŸ§© ç»„ä»¶æ‹†åˆ†ç­–ç•¥

### ä»€ä¹ˆæ—¶å€™æ‹†åˆ†ç»„ä»¶ï¼Ÿ

#### âœ… åº”è¯¥æ‹†åˆ†çš„æƒ…å†µï¼š

1. **åŠŸèƒ½ç‹¬ç«‹**ï¼šæœ‰æ˜ç¡®è¾¹ç•Œçš„åŠŸèƒ½åŒºåŸŸ

   ```vue
   <!-- âŒ ä¸å¥½çš„åšæ³• -->
   <template>
     <view class="page">
       <!-- å¤´éƒ¨åŒºåŸŸ 100è¡Œ -->
       <!-- å†…å®¹åŒºåŸŸ 200è¡Œ -->
       <!-- åº•éƒ¨åŒºåŸŸ 50è¡Œ -->
     </view>
   </template>

   <!-- âœ… å¥½çš„åšæ³• -->
   <template>
     <view class="page">
       <HeaderSection />
       <ContentArea />
       <FooterSection />
     </view>
   </template>
   ```

2. **é‡å¤ä½¿ç”¨**ï¼šåœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨ç›¸åŒçš„ UI ç»“æ„
3. **å¤æ‚é€»è¾‘**ï¼šç»„ä»¶å†…éƒ¨é€»è¾‘è¶…è¿‡ 50 è¡Œ
4. **ç‹¬ç«‹çŠ¶æ€**ï¼šæœ‰è‡ªå·±çš„çŠ¶æ€ç®¡ç†éœ€æ±‚

#### âŒ ä¸åº”è¯¥è¿‡åº¦æ‹†åˆ†çš„æƒ…å†µï¼š

1. **ç®€å•çš„ UI**ï¼šåªæœ‰å‡ è¡Œä»£ç çš„ç®€å•å…ƒç´ 
2. **ç´§å¯†è€¦åˆ**ï¼šä¸çˆ¶ç»„ä»¶é«˜åº¦ä¾èµ–çš„éƒ¨åˆ†
3. **ä¸€æ¬¡æ€§ä½¿ç”¨**ï¼šç¡®å®šä¸ä¼šå¤ç”¨çš„å°ç‰‡æ®µ

### ç»„ä»¶è®¾è®¡æ¨¡å¼

#### 1. å®¹å™¨ç»„ä»¶ (Container Component)

```vue
<!-- pages/user-profile/index.vue -->
<template>
  <view class="user-profile-page">
    <UserHeader :user="userInfo" @edit="handleEdit" />
    <UserStats :stats="userStats" />
    <UserActions @logout="handleLogout" />
  </view>
</template>

<script setup>
import { useUserProfile } from "./composables/useUserProfile.js";
import UserHeader from "./components/UserHeader.vue";
import UserStats from "./components/UserStats.vue";
import UserActions from "./components/UserActions.vue";

// åªè´Ÿè´£æ•°æ®è·å–å’Œäº‹ä»¶å¤„ç†
const { userInfo, userStats, handleEdit, handleLogout } = useUserProfile();
</script>
```

#### 2. å±•ç¤ºç»„ä»¶ (Presentational Component)

```vue
<!-- components/UserHeader.vue -->
<template>
  <view class="user-header">
    <image :src="user.avatar" class="avatar" />
    <view class="info">
      <text class="name">{{ user.name }}</text>
      <text class="email">{{ user.email }}</text>
    </view>
    <button @click="$emit('edit')" class="edit-btn">ç¼–è¾‘</button>
  </view>
</template>

<script setup>
// åªè´Ÿè´£å±•ç¤ºï¼Œä¸å¤„ç†ä¸šåŠ¡é€»è¾‘
defineProps({
  user: {
    type: Object,
    required: true,
  },
});

defineEmits(["edit"]);
</script>
```

## ğŸª ç»„åˆå¼å‡½æ•°è®¾è®¡

### å‘½åè§„èŒƒ

- ä»¥ `use` å¼€å¤´ï¼š`useUserData`ã€`useFormValidation`
- æè¿°åŠŸèƒ½ï¼š`useApiRequest`ã€`useLocalStorage`
- é¿å…æ³›åŒ–ï¼šä¸è¦å†™ `useUtils`ï¼Œè¦å†™ `useFormUtils`

### è®¾è®¡åŸåˆ™

#### 1. å•ä¸€èŒè´£

```javascript
// âŒ ä¸å¥½çš„åšæ³• - åŠŸèƒ½æ‚ç³…
export function usePageLogic() {
  // ç”¨æˆ·æ•°æ®
  const user = ref({});
  // è¡¨å•éªŒè¯
  const validateForm = () => {};
  // ç½‘ç»œè¯·æ±‚
  const fetchData = () => {};
  // ä¸»é¢˜åˆ‡æ¢
  const toggleTheme = () => {};

  return { user, validateForm, fetchData, toggleTheme };
}

// âœ… å¥½çš„åšæ³• - æŒ‰åŠŸèƒ½æ‹†åˆ†
export function useUserData() {
  const user = ref({});
  const fetchUser = async () => {
    /* ... */
  };
  return { user, fetchUser };
}

export function useFormValidation() {
  const errors = ref({});
  const validate = (data) => {
    /* ... */
  };
  return { errors, validate };
}
```

#### 2. æ¸…æ™°çš„è¾“å…¥è¾“å‡º

```javascript
// âœ… å¥½çš„ç»„åˆå¼å‡½æ•°è®¾è®¡
export function useApiRequest(url, options = {}) {
  const data = ref(null);
  const loading = ref(false);
  const error = ref(null);

  const execute = async (params) => {
    loading.value = true;
    error.value = null;

    try {
      const response = await uni.request({
        url: url,
        data: params,
        ...options,
      });
      data.value = response.data;
    } catch (err) {
      error.value = err;
    } finally {
      loading.value = false;
    }
  };

  return {
    // çŠ¶æ€
    data: readonly(data),
    loading: readonly(loading),
    error: readonly(error),
    // æ–¹æ³•
    execute,
  };
}
```

#### 3. ç”Ÿå‘½å‘¨æœŸç®¡ç†

```javascript
export function usePageData() {
  const data = ref([]);

  const fetchData = async () => {
    // è·å–æ•°æ®é€»è¾‘
  };

  // åœ¨ç»„åˆå¼å‡½æ•°å†…éƒ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ
  onMounted(() => {
    fetchData();
  });

  onUnmounted(() => {
    // æ¸…ç†é€»è¾‘
  });

  return { data, fetchData };
}
```

### å¸¸ç”¨çš„ç»„åˆå¼å‡½æ•°æ¨¡å¼

#### 1. æ•°æ®è·å–æ¨¡å¼

```javascript
// composables/useApiData.js
export function useApiData(endpoint) {
  const data = ref(null);
  const loading = ref(false);
  const error = ref(null);

  const fetch = async () => {
    loading.value = true;
    try {
      const res = await uni.request({ url: endpoint });
      data.value = res.data;
    } catch (err) {
      error.value = err;
    } finally {
      loading.value = false;
    }
  };

  const refresh = () => fetch();

  return { data, loading, error, fetch, refresh };
}
```

#### 2. è¡¨å•å¤„ç†æ¨¡å¼

```javascript
// composables/useForm.js
export function useForm(initialData, validationRules) {
  const formData = ref({ ...initialData });
  const errors = ref({});
  const isValid = computed(() => Object.keys(errors.value).length === 0);

  const validate = () => {
    errors.value = {};
    Object.keys(validationRules).forEach((field) => {
      const rule = validationRules[field];
      const value = formData.value[field];
      if (!rule(value)) {
        errors.value[field] = `${field} æ ¼å¼ä¸æ­£ç¡®`;
      }
    });
  };

  const reset = () => {
    formData.value = { ...initialData };
    errors.value = {};
  };

  return { formData, errors, isValid, validate, reset };
}
```

#### 3. æœ¬åœ°å­˜å‚¨æ¨¡å¼

```javascript
// composables/useLocalStorage.js
export function useLocalStorage(key, defaultValue) {
  const storedValue = uni.getStorageSync(key) || defaultValue;
  const value = ref(storedValue);

  watch(
    value,
    (newValue) => {
      uni.setStorageSync(key, newValue);
    },
    { deep: true }
  );

  const remove = () => {
    uni.removeStorageSync(key);
    value.value = defaultValue;
  };

  return { value, remove };
}
```

## ğŸ¨ æ ·å¼ç®¡ç†

### 1. æ ·å¼æ–‡ä»¶ç»“æ„

```scss
// styles/index.scss - ä¸»æ ·å¼æ–‡ä»¶
@import "./variables.scss";
@import "./mixins.scss";
@import "./components.scss";

.page-container {
  // é¡µé¢çº§æ ·å¼
}

// styles/variables.scss - å˜é‡å®šä¹‰
$primary-color: #7f4515;
$border-radius: 16rpx;
$spacing-sm: 16rpx;
$spacing-md: 32rpx;

// styles/mixins.scss - æ··å…¥å®šä¹‰
@mixin button-style {
  border-radius: $border-radius;
  padding: $spacing-sm $spacing-md;
  transition: all 0.3s ease;
}

// styles/components.scss - ç»„ä»¶æ ·å¼
.header-section {
  // ç»„ä»¶æ ·å¼
}
```

### 2. CSS Modules æˆ– scoped æ ·å¼

```vue
<!-- ä½¿ç”¨ scoped é¿å…æ ·å¼æ±¡æŸ“ -->
<template>
  <view class="component">
    <text class="title">æ ‡é¢˜</text>
  </view>
</template>

<style lang="scss" scoped>
.component {
  .title {
    // æ ·å¼åªåœ¨å½“å‰ç»„ä»¶ç”Ÿæ•ˆ
  }
}
</style>
```

## ğŸš€ å®æˆ˜ç¤ºä¾‹

### å®Œæ•´çš„é¡µé¢æ¨¡å—åŒ–ç¤ºä¾‹

#### 1. ä¸»é¡µé¢æ–‡ä»¶

```vue
<!-- pages/product-list/index.vue -->
<template>
  <view class="product-list-page">
    <SearchHeader v-model="searchQuery" @search="handleSearch" />
    <FilterTabs :active="activeFilter" @change="handleFilterChange" />
    <ProductGrid
      :products="products"
      :loading="loading"
      @item-click="handleProductClick" />
    <LoadMore v-if="hasMore" @load="loadMoreProducts" />
  </view>
</template>

<script setup>
import SearchHeader from "./components/SearchHeader.vue";
import FilterTabs from "./components/FilterTabs.vue";
import ProductGrid from "./components/ProductGrid.vue";
import LoadMore from "./components/LoadMore.vue";

import { useProductList } from "./composables/useProductList.js";
import { useSearch } from "./composables/useSearch.js";

// ç»„åˆå¤šä¸ªåŠŸèƒ½
const { products, loading, hasMore, loadMoreProducts, handleProductClick } =
  useProductList();

const { searchQuery, activeFilter, handleSearch, handleFilterChange } =
  useSearch();
</script>

<style lang="scss" scoped>
@import "./styles/index.scss";
</style>
```

#### 2. ç»„åˆå¼å‡½æ•°

```javascript
// composables/useProductList.js
export function useProductList() {
  const products = ref([]);
  const loading = ref(false);
  const hasMore = ref(true);
  const page = ref(1);

  const fetchProducts = async (reset = false) => {
    if (loading.value) return;

    loading.value = true;
    try {
      const res = await uni.request({
        url: "/api/products",
        data: { page: reset ? 1 : page.value },
      });

      if (reset) {
        products.value = res.data.list;
        page.value = 1;
      } else {
        products.value.push(...res.data.list);
      }

      hasMore.value = res.data.hasMore;
      page.value++;
    } catch (error) {
      uni.showToast({ title: "åŠ è½½å¤±è´¥", icon: "none" });
    } finally {
      loading.value = false;
    }
  };

  const loadMoreProducts = () => fetchProducts(false);
  const handleProductClick = (product) => {
    uni.navigateTo({ url: `/pages/product-detail/index?id=${product.id}` });
  };

  onMounted(() => fetchProducts(true));

  return {
    products: readonly(products),
    loading: readonly(loading),
    hasMore: readonly(hasMore),
    loadMoreProducts,
    handleProductClick,
    refreshProducts: () => fetchProducts(true),
  };
}
```

## ğŸ“ å¼€å‘æµç¨‹

### ä»é›¶å¼€å§‹çš„æ¨¡å—åŒ–å¼€å‘æ­¥éª¤

#### 1. éœ€æ±‚åˆ†æå’Œè®¾è®¡é˜¶æ®µ

```
é¡µé¢éœ€æ±‚ï¼šç”¨æˆ·åˆ—è¡¨é¡µ
åŠŸèƒ½ç‚¹ï¼š
- æœç´¢ç”¨æˆ·
- ç­›é€‰æ¡ä»¶
- ç”¨æˆ·å¡ç‰‡å±•ç¤º
- åˆ†é¡µåŠ è½½
- ç”¨æˆ·è¯¦æƒ…è·³è½¬
```

#### 2. ç›®å½•ç»“æ„åˆ›å»º

```bash
mkdir pages/user-list
cd pages/user-list
touch index.vue
mkdir components composables styles utils
```

#### 3. ç»„ä»¶æ‹†åˆ†è®¾è®¡

```
UserListPage (ä¸»é¡µé¢)
â”œâ”€â”€ SearchBar (æœç´¢ç»„ä»¶)
â”œâ”€â”€ FilterPanel (ç­›é€‰ç»„ä»¶)
â”œâ”€â”€ UserCard (ç”¨æˆ·å¡ç‰‡)
â””â”€â”€ LoadingMore (åŠ è½½æ›´å¤š)

Composables:
â”œâ”€â”€ useUserList (ç”¨æˆ·åˆ—è¡¨é€»è¾‘)
â”œâ”€â”€ useSearch (æœç´¢é€»è¾‘)
â””â”€â”€ useFilter (ç­›é€‰é€»è¾‘)
```

#### 4. æŒ‰ä¼˜å…ˆçº§å¼€å‘

```
ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºåŸºç¡€ç»„ä»¶å’Œæ ·å¼
ç¬¬äºŒæ­¥ï¼šå®ç°æ ¸å¿ƒåŠŸèƒ½çš„ç»„åˆå¼å‡½æ•°
ç¬¬ä¸‰æ­¥ï¼šç»„è£…ä¸»é¡µé¢
ç¬¬å››æ­¥ï¼šä¼˜åŒ–å’Œæµ‹è¯•
```

#### 5. ä»£ç å®¡æŸ¥æ¸…å•

- [ ] æ¯ä¸ªæ–‡ä»¶æ˜¯å¦èŒè´£å•ä¸€ï¼Ÿ
- [ ] ç»„ä»¶æ˜¯å¦å¯å¤ç”¨ï¼Ÿ
- [ ] ç»„åˆå¼å‡½æ•°æ˜¯å¦å¯æµ‹è¯•ï¼Ÿ
- [ ] æ ·å¼æ˜¯å¦æœ‰ä½œç”¨åŸŸï¼Ÿ
- [ ] æ˜¯å¦æœ‰ä»£ç é‡å¤ï¼Ÿ

## âš ï¸ å¸¸è§é™·é˜±

### 1. è¿‡åº¦æŠ½è±¡

```javascript
// âŒ è¿‡åº¦æŠ½è±¡ - éš¾ä»¥ç†è§£å’Œç»´æŠ¤
export function useGenericManager(config) {
  // 200è¡Œé€šç”¨é€»è¾‘
}

// âœ… é€‚åº¦æŠ½è±¡ - æ¸…æ™°æ˜äº†
export function useUserManager() {
  // ä¸“é—¨å¤„ç†ç”¨æˆ·ç›¸å…³é€»è¾‘
}
```

### 2. ç»„ä»¶é—´ç´§è€¦åˆ

```vue
<!-- âŒ ç´§è€¦åˆ -->
<template>
  <ChildComponent />
</template>
<script>
// å­ç»„ä»¶ç›´æ¥è®¿é—®çˆ¶ç»„ä»¶çš„æ•°æ®
</script>

<!-- âœ… æ¾è€¦åˆ -->
<template>
  <ChildComponent :data="parentData" @event="handleEvent" />
</template>
```

### 3. çŠ¶æ€ç®¡ç†æ··ä¹±

```javascript
// âŒ çŠ¶æ€åˆ†æ•£
const user = ref({}); // åœ¨ç»„ä»¶A
const userSettings = ref({}); // åœ¨ç»„ä»¶B

// âœ… é›†ä¸­ç®¡ç†
export function useUserStore() {
  const user = ref({});
  const settings = ref({});
  return { user, settings };
}
```

### 4. å‘½åä¸è§„èŒƒ

```javascript
// âŒ ä¸å¥½çš„å‘½å
export function useData() {} // å¤ªæ³›åŒ–
export function useStuff() {} // æ— æ„ä¹‰
export function getData() {} // ä¸ç¬¦åˆç»„åˆå¼å‡½æ•°è§„èŒƒ

// âœ… å¥½çš„å‘½å
export function useUserProfile() {}
export function useProductCart() {}
export function useFormValidation() {}
```

## ğŸ“ æ€»ç»“

### å…³é”®è¦ç‚¹

1. **å…ˆæ€è€ƒï¼Œåç¼–ç **ï¼šè®¾è®¡å¥½ç»“æ„å†å¼€å§‹å†™ä»£ç 
2. **å°æ­¥å¿«è·‘**ï¼šå…ˆå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼Œå†é€æ­¥é‡æ„
3. **ä¿æŒç®€å•**ï¼šé¿å…è¿‡åº¦è®¾è®¡å’ŒæŠ½è±¡
4. **æŒç»­é‡æ„**ï¼šå®šæœŸæ£€æŸ¥å’Œä¼˜åŒ–ä»£ç ç»“æ„

### å®è·µå»ºè®®

1. **ä»ç®€å•é¡µé¢å¼€å§‹**ï¼šåœ¨ç®€å•é¡µé¢ä¸Šç»ƒä¹ æ¨¡å—åŒ–
2. **ä»£ç å¤ç”¨**ï¼šç§¯ç´¯å¸¸ç”¨çš„ç»„åˆå¼å‡½æ•°å’Œç»„ä»¶
3. **æ–‡æ¡£è®°å½•**ï¼šä¸ºæ¯ä¸ªæ¨¡å—å†™æ¸…æ¥šçš„æ³¨é‡Š
4. **å›¢é˜Ÿè§„èŒƒ**ï¼šå»ºç«‹å›¢é˜Ÿç»Ÿä¸€çš„ä»£ç è§„èŒƒ

è®°ä½ï¼š**å¥½çš„æ¨¡å—åŒ–ä¸æ˜¯ä¸ºäº†æ‹†åˆ†è€Œæ‹†åˆ†ï¼Œè€Œæ˜¯ä¸ºäº†è®©ä»£ç æ›´æ¸…æ™°ã€æ›´æ˜“ç»´æŠ¤ã€æ›´å¥½æµ‹è¯•ï¼**

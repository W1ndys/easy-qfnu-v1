import{a2 as e,s,l as t,A as a,C as l,r as c,c as i,w as o,g as r,o as n,a as u,j as d,n as f,t as p,d as h,f as m,R as _,F as y,k as g,i as k,K as b}from"./index-DUTrn-cQ.js";import{r as q,_ as F}from"./uni-app.es.D8sHLrG0.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const z=x({data:()=>({searchForm:{question:""},searchResults:[],loading:!1,searched:!1,emptyMessage:"未找到相关题目",questionError:!1,questionFocused:!1}),computed:{hasResults(){return this.searchResults.length>0},questionHint(){const e=this.searchForm.question.trim().length;return 0===e?"请输入题目内容或关键词":e<2?`至少需要2个字符，当前${e}个字符`:`已输入${e}个字符`},canSearch(){return this.searchForm.question.trim().length>=2}},onLoad(){e({title:"新生入学考试辅助"})},methods:{validateQuestion(){const e=this.searchForm.question.trim().length;this.questionError=e>0&&e<2},async handleSearch(){if(this.searchForm.question.trim())if(this.searchForm.question.trim().length<2)s({title:"题目内容至少需要2个字符",icon:"none"});else{this.loading=!0,this.searched=!0;try{const e=await this.searchQuestions({query:this.searchForm.question.trim(),topk:3,threshold:.2});e.ok?(this.searchResults=e.results||[],this.hasResults||(this.emptyMessage="未找到相关题目，请尝试其他关键词")):(this.searchResults=[],this.emptyMessage=e.message||"搜索失败",s({title:this.emptyMessage,icon:"none"}))}catch(e){console.error("搜索题目失败:",e),this.searchResults=[];let t="网络错误，请重试";e.message&&(e.message.includes("HTTP 422")?t="输入参数格式错误，请检查输入内容":e.message.includes("HTTP 400")?t="请求参数错误，请检查输入内容":e.message.includes("HTTP 500")?t="服务器内部错误，请稍后重试":e.message.includes("HTTP")&&(t=`请求失败: ${e.message}`)),this.emptyMessage=t,s({title:t,icon:"none",duration:3e3})}finally{this.loading=!1}}else s({title:"请输入题目内容",icon:"none"})},handleReset(){this.searchForm={question:""},this.searchResults=[],this.searched=!1,this.questionError=!1},async searchQuestions(e){const s=t().globalData.apiBaseURL;return new Promise(((t,l)=>{a({url:`${s}/api/v1/question/freshman-question-search`,method:"POST",data:e,header:{"Content-Type":"application/json"},success:e=>{var s;if(200!==e.statusCode)return console.error("API请求失败:",e),void l(new Error(`HTTP ${e.statusCode}: ${(null==(s=e.data)?void 0:s.message)||"请求失败"}`));t(e.data)},fail:e=>{l(e)}})}))},formatOptions:e=>e&&"object"==typeof e?Object.keys(e).map((s=>({key:s,value:e[s]}))).sort(((e,s)=>e.key.localeCompare(s.key))):[],copyGroupNumber(){l({data:"1046961227",success:()=>{s({title:"群号已复制",icon:"success",duration:2e3})},fail:()=>{s({title:"复制失败",icon:"none",duration:2e3})}})}}},[["render",function(e,s,t,a,l,x){const z=r,R=g,v=q(c("uni-icons"),F),C=k,T=b;return n(),i(z,{class:"page-container page-rounded-container"},{default:o((()=>[u(z,{class:"background-decoration"},{default:o((()=>[u(z,{class:"circle circle-1"}),u(z,{class:"circle circle-2"}),u(z,{class:"circle circle-3"})])),_:1}),u(z,{class:"page-header"},{default:o((()=>[u(z,{class:"header-content"},{default:o((()=>[u(R,{class:"page-title"},{default:o((()=>[d("新生入学考试辅助")])),_:1}),u(R,{class:"page-subtitle"},{default:o((()=>[d("Freshman Examination Q&A")])),_:1})])),_:1})])),_:1}),u(z,{class:"disclaimer-card modern-card"},{default:o((()=>[u(z,{class:"disclaimer-header"},{default:o((()=>[u(z,{class:"disclaimer-icon"},{default:o((()=>[u(v,{type:"info-filled",size:"24",color:"#ff6b35"})])),_:1}),u(R,{class:"disclaimer-title"},{default:o((()=>[d("重要声明")])),_:1})])),_:1}),u(z,{class:"disclaimer-content"},{default:o((()=>[u(R,{class:"disclaimer-text"},{default:o((()=>[d(" 本题库由新生手册根据大模型生成，仅供参考。使用前请确保您已充分阅读并学习曲阜师范大学新生手册内容并遵守相关规定。使用本程序造成的一切后果与本程序无关，使用本程序即代表您同意上方声明内容。 ")])),_:1})])),_:1})])),_:1}),u(z,{class:"group-info-card modern-card"},{default:o((()=>[u(z,{class:"group-header"},{default:o((()=>[u(z,{class:"group-icon"},{default:o((()=>[u(v,{type:"chat-filled",size:"24",color:"#1890ff"})])),_:1}),u(R,{class:"group-title"},{default:o((()=>[d("学习交流群")])),_:1})])),_:1}),u(z,{class:"group-content"},{default:o((()=>[u(R,{class:"group-description"},{default:o((()=>[d("曲师大25级选课学习交流群")])),_:1}),u(z,{class:"group-number",onClick:x.copyGroupNumber},{default:o((()=>[u(R,{class:"group-label"},{default:o((()=>[d("群号：")])),_:1}),u(R,{class:"group-id"},{default:o((()=>[d("1046961227")])),_:1}),u(z,{class:"copy-icon"},{default:o((()=>[u(v,{type:"copy",size:"16",color:"#1890ff"})])),_:1})])),_:1},8,["onClick"]),u(R,{class:"group-hint"},{default:o((()=>[d("点击群号可复制")])),_:1})])),_:1})])),_:1}),u(z,{class:"content-wrapper"},{default:o((()=>[u(z,{class:"search-card modern-card"},{default:o((()=>[u(z,{class:"card-header"},{default:o((()=>[u(z,{class:"header-icon"},{default:o((()=>[u(v,{type:"search",size:"24",color:"#7f4515"})])),_:1}),u(z,{class:"header-text"},{default:o((()=>[u(R,{class:"card-title"},{default:o((()=>[d("智能搜索")])),_:1}),u(R,{class:"card-subtitle"},{default:o((()=>[d("输入题目关键词进行语义搜索")])),_:1})])),_:1})])),_:1}),u(z,{class:"form-content"},{default:o((()=>[u(z,{class:"form-group"},{default:o((()=>[u(z,{class:"input-label"},{default:o((()=>[u(v,{type:"help",size:"20",color:"#495057"}),u(R,null,{default:o((()=>[d("题目内容")])),_:1})])),_:1}),u(z,{class:"input-wrapper"},{default:o((()=>[u(C,{class:f(["modern-textarea",{"input-error":l.questionError,"input-focus":l.questionFocused}]),modelValue:l.searchForm.question,"onUpdate:modelValue":s[0]||(s[0]=e=>l.searchForm.question=e),placeholder:"请输入题目关键词或完整题目","auto-height":"",onInput:x.validateQuestion,onFocus:s[1]||(s[1]=e=>l.questionFocused=!0),onBlur:s[2]||(s[2]=e=>l.questionFocused=!1)},null,8,["class","modelValue","onInput"]),u(z,{class:f(["input-line",{active:l.questionFocused}])},null,8,["class"])])),_:1}),u(R,{class:f(["input-hint",{"hint-error":l.questionError}])},{default:o((()=>[d(p(x.questionHint),1)])),_:1},8,["class"])])),_:1}),u(z,{class:"button-group"},{default:o((()=>[u(T,{class:"action-btn primary-btn",onClick:x.handleSearch,loading:l.loading,disabled:!x.canSearch},{default:o((()=>[l.loading?h("",!0):(n(),i(v,{key:0,type:"search",size:"20",color:"#ffffff"})),u(R,null,{default:o((()=>[d(p(l.loading?"搜索中...":"开始搜索"),1)])),_:1})])),_:1},8,["onClick","loading","disabled"]),u(T,{class:"action-btn secondary-btn",onClick:x.handleReset},{default:o((()=>[u(v,{type:"refresh",size:"20",color:"#495057"}),u(R,null,{default:o((()=>[d("重置")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),x.hasResults?(n(),i(z,{key:0,class:"results-section"},{default:o((()=>[u(z,{class:"results-header"},{default:o((()=>[u(z,{class:"results-info"},{default:o((()=>[u(R,{class:"results-title"},{default:o((()=>[d("搜索结果")])),_:1}),u(R,{class:"results-count"},{default:o((()=>[d("找到 "+p(l.searchResults.length)+" 个相关题目",1)])),_:1})])),_:1})])),_:1}),(n(!0),m(y,null,_(l.searchResults,((e,s)=>(n(),i(z,{class:"question-card modern-card",key:s},{default:o((()=>[u(z,{class:"question-header"},{default:o((()=>[u(z,{class:"question-info"},{default:o((()=>[u(z,{class:"question-icon"},{default:o((()=>[u(v,{type:"help-filled",size:"20",color:"#7f4515"})])),_:1}),u(R,{class:"question-number"},{default:o((()=>[d("题目 "+p(s+1),1)])),_:2},1024),e.type?(n(),i(z,{key:0,class:"type-badge"},{default:o((()=>[u(R,{class:"type-text"},{default:o((()=>[d(p(e.type),1)])),_:2},1024)])),_:2},1024)):h("",!0),u(z,{class:"similarity-badge"},{default:o((()=>[u(R,{class:"similarity-text"},{default:o((()=>[d("相似度: "+p((100*e.score).toFixed(1))+"%",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),u(z,{class:"question-content"},{default:o((()=>[u(z,{class:"question-text-section"},{default:o((()=>[u(R,{class:"question-text"},{default:o((()=>[d(p(e.question),1)])),_:2},1024)])),_:2},1024),e.options?(n(),i(z,{key:0,class:"options-section"},{default:o((()=>[u(z,{class:"options-list"},{default:o((()=>[(n(!0),m(y,null,_(x.formatOptions(e.options),(s=>(n(),i(z,{class:f(["option-item",{"correct-option":e.answer&&s.key===e.answer.letter}]),key:s.key},{default:o((()=>[u(R,{class:"option-label"},{default:o((()=>[d(p(s.key)+".",1)])),_:2},1024),u(R,{class:"option-text"},{default:o((()=>[d(p(s.value),1)])),_:2},1024),e.answer&&s.key===e.answer.letter?(n(),i(z,{key:0,class:"correct-mark"},{default:o((()=>[u(v,{type:"checkmarkempty",size:"16",color:"#52c41a"})])),_:1})):h("",!0)])),_:2},1032,["class"])))),128))])),_:2},1024)])),_:2},1024)):h("",!0),e.category||e.difficulty||e.type?(n(),i(z,{key:1,class:"question-meta"},{default:o((()=>[e.type?(n(),i(z,{key:0,class:"meta-item"},{default:o((()=>[u(R,{class:"meta-label"},{default:o((()=>[d("类型")])),_:1}),u(R,{class:"meta-value"},{default:o((()=>[d(p(e.type),1)])),_:2},1024)])),_:2},1024)):h("",!0),e.category?(n(),i(z,{key:1,class:"meta-item"},{default:o((()=>[u(R,{class:"meta-label"},{default:o((()=>[d("分类")])),_:1}),u(R,{class:"meta-value"},{default:o((()=>[d(p(e.category),1)])),_:2},1024)])),_:2},1024)):h("",!0),e.difficulty?(n(),i(z,{key:2,class:"meta-item"},{default:o((()=>[u(R,{class:"meta-label"},{default:o((()=>[d("难度")])),_:1}),u(R,{class:"meta-value"},{default:o((()=>[d(p(e.difficulty),1)])),_:2},1024)])),_:2},1024)):h("",!0)])),_:2},1024)):h("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):l.searched&&!l.loading?(n(),i(z,{key:1,class:"empty-state modern-card"},{default:o((()=>[u(z,{class:"empty-content"},{default:o((()=>[u(z,{class:"empty-icon"},{default:o((()=>[u(v,{type:"info",size:"80",color:"#adb5bd"})])),_:1}),u(R,{class:"empty-title"},{default:o((()=>[d("未找到相关题目")])),_:1}),u(R,{class:"empty-subtitle"},{default:o((()=>[d(p(l.emptyMessage),1)])),_:1}),u(T,{class:"action-btn primary-btn retry-btn",onClick:x.handleReset},{default:o((()=>[u(v,{type:"refresh",size:"20",color:"#ffffff"}),u(R,null,{default:o((()=>[d("重新搜索")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})):l.searched||l.loading?l.loading?(n(),i(z,{key:3,class:"loading-state modern-card"},{default:o((()=>[u(z,{class:"loading-content"},{default:o((()=>[u(z,{class:"loading-spinner"},{default:o((()=>[u(v,{type:"spinner-cycle",size:"60",color:"#7f4515"})])),_:1}),u(R,{class:"loading-text"},{default:o((()=>[d("正在搜索题目...")])),_:1}),u(R,{class:"loading-subtitle"},{default:o((()=>[d("使用AI语义分析匹配相关内容")])),_:1})])),_:1})])),_:1})):h("",!0):(n(),i(z,{key:2,class:"initial-state modern-card"},{default:o((()=>[u(z,{class:"initial-content"},{default:o((()=>[u(z,{class:"initial-icon"},{default:o((()=>[u(v,{type:"help",size:"80",color:"#7f4515"})])),_:1}),u(R,{class:"initial-title"},{default:o((()=>[d("欢迎使用搜索功能")])),_:1}),u(R,{class:"initial-subtitle"},{default:o((()=>[d("输入题目关键词，快速找到相关题目和答案")])),_:1}),u(z,{class:"tips-section"},{default:o((()=>[u(z,{class:"tip-item"},{default:o((()=>[u(v,{type:"checkmarkempty",size:"16",color:"#52c41a"}),u(R,{class:"tip-text"},{default:o((()=>[d("支持关键词搜索")])),_:1})])),_:1}),u(z,{class:"tip-item"},{default:o((()=>[u(v,{type:"checkmarkempty",size:"16",color:"#52c41a"}),u(R,{class:"tip-text"},{default:o((()=>[d("智能语义匹配")])),_:1})])),_:1}),u(z,{class:"tip-item"},{default:o((()=>[u(v,{type:"checkmarkempty",size:"16",color:"#52c41a"}),u(R,{class:"tip-text"},{default:o((()=>[d("精准答案推荐")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1})}],["__scopeId","data-v-017ef6aa"]]);export{z as default};

import{B as e,Z as t,r as a,o as l,c as s,w as o,a as r,b as n,t as u,L as i,k as c,j as d,h as f,d as _,i as m,M as p,a8 as y,a6 as v,m as g,F as w,N as k,H as h,D as b,J as D,u as C,G as $,E as S,a4 as T,f as x,_ as z,A as M}from"./index-Cr0cHG7E.js";import{_ as I,r as E,a as N,o as A,b as L}from"./uni-icons.Cmp-woHJ.js";import{P as j}from"./PageLayout.B4b5ukJp.js";import{M as Y}from"./ModernCard.C9bNbue3.js";import{L as F,E as R}from"./EmptyState.BgM0aeQo.js";const U=I({__name:"CourseCard",props:{course:{type:Object,default:null},currentTime:{type:String,default:""}},emits:["click"],setup(e,{emit:p}){const y=e,v=p,{timeDisplay:g,cardStyle:w,getTypeTagStyle:k,formatClassName:h,formatLocation:b}=function(e){return{timeDisplay:t((()=>{var t;if(!(null==(t=e.course)?void 0:t.time_info))return"";const a=e.course.time_info,{start_time:l,end_time:s,is_cross_period:o,actual_periods:r,period_name:n}=a;return o&&r&&r.length>0?`第${r[0]}-${r[r.length-1]}节 ${l}-${s}`:`${n||""} ${l}-${s}`})),cardStyle:t((()=>({background:"#ffffff",borderLeft:"4rpx solid #d4b896"}))),getTypeTagStyle:e=>({"必修":{background:"#ffebee",color:"#c62828"},"选修":{background:"#fff3e0",color:"#ef6c00"},"任选":{background:"#f3e5f5",color:"#7b1fa2"},"限选":{background:"#fff3e0",color:"#f57c00"},"实践":{background:"#e8f5e8",color:"#2e7d32"},"通识":{background:"#e3f2fd",color:"#1565c0"}}[e]||{background:"#f5f5f5",color:"#757575"}),formatClassName:e=>e?e.length>20?e.substring(0,20)+"...":e:"",formatLocation:e=>e?e.trim().replace(/\s+/g," "):""}}(y),D=t((()=>{var e;if(!(null==(e=y.course)?void 0:e.time_info)||!y.currentTime)return"";const{start_time:t,end_time:a}=y.course.time_info,l=y.currentTime;if(l>=t&&l<=a)return"current";if(l<t){const e=C(t),a=C(l);if(e-a<=30&&e-a>0)return"upcoming"}else if(l>a)return"finished";return""})),C=e=>{const[t,a]=e.split(":").map(Number);return 60*t+a},$=()=>{y.course&&v("click",y.course)};return(t,p)=>{const y=_,v=E(a("uni-icons"),N),C=m;return e.course?(l(),s(y,{key:0,class:f(["course-card",D.value]),style:d(i(w)),onClick:$},{default:o((()=>[r(y,{class:"course-header"},{default:o((()=>[r(y,{class:"course-title"},{default:o((()=>[n(u(e.course.name),1)])),_:1}),r(y,{class:"course-meta"},{default:o((()=>[r(y,{class:"time-info"},{default:o((()=>{var t;return[r(v,{type:"clock",size:"16",color:"rgba(127,69,21,0.7)"}),r(C,null,{default:o((()=>[n(u(i(g)),1)])),_:1}),(null==(t=e.course.time_info)?void 0:t.is_cross_period)?(l(),s(C,{key:0,class:"cross-period-indicator"},{default:o((()=>[n("跨节")])),_:1})):c("",!0)]})),_:1}),r(y,{class:"course-type-tag",style:d(i(k)(e.course.course_type))},{default:o((()=>[n(u(e.course.course_type),1)])),_:1},8,["style"])])),_:1})])),_:1}),r(y,{class:"course-body"},{default:o((()=>[r(y,{class:"course-details"},{default:o((()=>[r(y,{class:"detail-row"},{default:o((()=>[r(y,{class:"detail-icon"},{default:o((()=>[r(v,{type:"location",size:"16",color:"#6c757d"})])),_:1}),r(C,{class:"detail-text location"},{default:o((()=>[n(u(i(b)(e.course.location)),1)])),_:1})])),_:1}),e.course.class_name?(l(),s(y,{key:0,class:"detail-row"},{default:o((()=>[r(y,{class:"detail-icon"},{default:o((()=>[r(v,{type:"home",size:"16",color:"#495057"})])),_:1}),r(C,{class:"detail-text class-name"},{default:o((()=>[n(u(i(h)(e.course.class_name)),1)])),_:1})])),_:1})):c("",!0)])),_:1}),e.course.credits?(l(),s(y,{key:0,class:"credits-info"},{default:o((()=>[r(y,{class:"credits-label"},{default:o((()=>[r(v,{type:"star",size:"14",color:"#6c757d"}),r(C,null,{default:o((()=>[n("学分")])),_:1})])),_:1}),r(C,{class:"credits-value"},{default:o((()=>[n(u(e.course.credits),1)])),_:1})])),_:1})):c("",!0)])),_:1})])),_:1},8,["class","style"])):(l(),s(y,{key:1,class:"empty-course-card"},{default:o((()=>[r(y,{class:"empty-icon"},{default:o((()=>[r(v,{type:"calendar",size:"32",color:"#adb5bd"})])),_:1}),r(y,{class:"empty-title"},{default:o((()=>[n("暂无课程")])),_:1}),r(y,{class:"empty-desc"},{default:o((()=>[n("今天没有安排课程，好好休息吧！")])),_:1})])),_:1}))}}},[["__scopeId","data-v-6c25cdad"]]),H=I({__name:"DaySchedule",props:{selectedDate:{type:String,required:!0},courses:{type:Array,default:()=>[]},timeSlots:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["course-click"],setup(d,{emit:f}){const h=d,b=f,{currentTime:D,dayInfo:C,dayCourses:$,dayStats:S,isToday:T,timeSlots:x,freeTimeSlots:z,initTimeUpdate:M}=function(a){const l=e(""),s=()=>{const e=new Date,t=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0");l.value=`${t}:${a}`},o=t((()=>{if(!a.selectedDate)return null;const e=new Date(a.selectedDate),t=0===e.getDay()?7:e.getDay();return{date:a.selectedDate,weekday:t,weekdayName:u(t),formatDate:i(e)}})),r=t((()=>{if(!a.courses||!o.value)return[];const{weekday:e}=o.value;return a.courses.filter((t=>t.time_info&&t.time_info.weekday===e)).sort(((e,t)=>{var a,l;const s=(null==(a=e.time_info)?void 0:a.start_time)||"00:00",o=(null==(l=t.time_info)?void 0:l.start_time)||"00:00";return s.localeCompare(o)}))})),n=t((()=>{const e=r.value;if(0===e.length)return{totalCourses:0,totalHours:0,firstCourse:null,lastCourse:null,currentCourse:null,nextCourse:null};const t=e.reduce(((e,t)=>{var a,l,s,o,r;return e+((null==(a=t.time_info)?void 0:a.period_count)||(null==(s=null==(l=t.time_info)?void 0:l.display_periods)?void 0:s.length)||(null==(r=null==(o=t.time_info)?void 0:o.time_slots)?void 0:r.length)||0)}),0),a=l.value,s=e.find((e=>{const{start_time:t,end_time:l}=e.time_info||{};return a>=t&&a<=l})),o=e.find((e=>{const{start_time:t}=e.time_info||{};return a<t}));return{totalCourses:e.length,totalHours:t,firstCourse:e[0],lastCourse:e[e.length-1],currentCourse:s,nextCourse:o}})),u=e=>({1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六",7:"星期日"}[e]||""),i=e=>{const t=e.getMonth()+1,a=e.getDate(),l=u(0===e.getDay()?7:e.getDay());return{month:t,day:a,weekday:l,full:`${t}月${a}日 ${l}`}},c=t((()=>{if(!a.selectedDate)return!1;const e=new Date,t=new Date(a.selectedDate);return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()})),d=t((()=>a.timeSlots?a.timeSlots.map((e=>{const t=r.value.filter((t=>{var a;return(null==(a=t.time_info)?void 0:a.period)===e.period}));return{...e,courses:t,isEmpty:0===t.length}})):[])),f=t((()=>d.value.filter((e=>e.isEmpty))));return{currentTime:l,dayInfo:o,dayCourses:r,dayStats:n,isToday:c,timeSlots:d,freeTimeSlots:f,initTimeUpdate:()=>(s(),setInterval(s,6e4)),updateCurrentTime:s,getWeekdayName:u,formatDisplayDate:i}}(h);let I=null;p((()=>{I=M()})),y((()=>{I&&clearInterval(I)}));const A=(e,t)=>{if(0===t)return!0;const a=$.value[t-1];return!!(a&&e.time_info&&a.time_info)&&e.time_info.period!==a.time_info.period},L=e=>{b("course-click",{course:e,dayInfo:C.value,isToday:T.value})};return(e,t)=>{const f=m,p=_,y=E(a("uni-icons"),N);return l(),s(p,{class:"day-schedule"},{default:o((()=>[r(p,{class:"schedule-header"},{default:o((()=>[r(p,{class:"schedule-title"},{default:o((()=>{var e,t;return[n(u((null==(t=null==(e=i(C))?void 0:e.formatDate)?void 0:t.full)||"课程表")+" ",1),i(T)?(l(),s(f,{key:0,class:"today-badge"},{default:o((()=>[n("今日")])),_:1})):c("",!0)]})),_:1}),r(p,{class:"schedule-stats"},{default:o((()=>[r(p,{class:"stat-item"},{default:o((()=>[r(y,{type:"calendar-filled",size:"16",color:"rgba(255,255,255,0.9)"}),r(f,null,{default:o((()=>[v("span",{class:"stat-value"},u(i(S).totalCourses),1),n(" 节课")])),_:1})])),_:1}),r(p,{class:"stat-item"},{default:o((()=>[r(y,{type:"clock-filled",size:"16",color:"rgba(255,255,255,0.9)"}),r(f,null,{default:o((()=>[v("span",{class:"stat-value"},u(i(S).totalHours),1),n(" 学时")])),_:1})])),_:1}),i(T)&&i(D)?(l(),s(p,{key:0,class:"stat-item"},{default:o((()=>[r(y,{type:"pulse",size:"16",color:"rgba(255,255,255,0.9)"}),r(f,null,{default:o((()=>[n(u(i(D)),1)])),_:1})])),_:1})):c("",!0)])),_:1})])),_:1}),i(S).currentCourse?(l(),s(p,{key:0,class:"current-course-indicator"},{default:o((()=>[r(p,{class:"indicator-icon"},{default:o((()=>[r(y,{type:"play-filled",size:"16",color:"#ffffff"})])),_:1}),r(p,{class:"indicator-text"},{default:o((()=>[n(" 正在进行："+u(i(S).currentCourse.name),1)])),_:1}),r(p,{class:"indicator-time"},{default:o((()=>{var e;return[n(u(null==(e=i(S).currentCourse.time_info)?void 0:e.end_time)+" 结束 ",1)]})),_:1})])),_:1})):i(S).nextCourse&&i(T)?(l(),s(p,{key:1,class:"next-course-indicator"},{default:o((()=>[r(p,{class:"indicator-icon"},{default:o((()=>[r(y,{type:"forward",size:"16",color:"#212529"})])),_:1}),r(p,{class:"indicator-text"},{default:o((()=>[n(" 下节课："+u(i(S).nextCourse.name),1)])),_:1}),r(p,{class:"indicator-time"},{default:o((()=>{var e;return[n(u(null==(e=i(S).nextCourse.time_info)?void 0:e.start_time)+" 开始 ",1)]})),_:1})])),_:1})):c("",!0),r(p,{class:"courses-container"},{default:o((()=>[i($).length>0?(l(),s(p,{key:0,class:"courses-list"},{default:o((()=>[(l(!0),g(w,null,k(i($),((e,t)=>(l(),g(w,{key:e.id},[A(e,t)?(l(),s(p,{key:0,class:"time-slot-divider"},{default:o((()=>[r(p,{class:"divider-line"}),r(p,{class:"divider-label"},{default:o((()=>{var t;return[n(u(null==(t=e.time_info)?void 0:t.period_name),1)]})),_:2},1024),r(p,{class:"divider-line"})])),_:2},1024)):c("",!0),r(U,{course:e,"current-time":i(D),onClick:L},null,8,["course","current-time"])],64)))),128)),i(z).length>0&&i(T)?(l(),s(p,{key:0,class:"free-time-notice"},{default:o((()=>[r(p,{class:"notice-icon"},{default:o((()=>[r(y,{type:"cup",size:"20",color:"#ffffff"})])),_:1}),r(p,{class:"notice-content"},{default:o((()=>[r(p,{class:"notice-title"},{default:o((()=>[n("空闲时间")])),_:1}),r(p,{class:"notice-desc"},{default:o((()=>[n(" 今天还有 "+u(i(z).length)+" 个时间段空闲，可以好好休息一下 ",1)])),_:1})])),_:1})])),_:1})):c("",!0)])),_:1})):(l(),s(p,{key:1,class:"empty-schedule"},{default:o((()=>[r(p,{class:"empty-icon"},{default:o((()=>[r(y,{type:"calendar",size:"48",color:"#adb5bd"})])),_:1}),r(p,{class:"empty-title"},{default:o((()=>[n(u(i(T)?"今天":"当天")+"没有安排课程",1)])),_:1}),r(p,{class:"empty-desc"},{default:o((()=>[n(u(i(T)?"好好享受这个美好的休息日吧！":"这天是个自由安排的日子"),1)])),_:1}),i(T)?(l(),s(p,{key:0,class:"empty-suggestions"},{default:o((()=>[r(p,{class:"suggestion-item"},{default:o((()=>[r(y,{type:"star",size:"14",color:"#868e96"}),r(f,null,{default:o((()=>[n("可以复习之前的课程内容")])),_:1})])),_:1}),r(p,{class:"suggestion-item"},{default:o((()=>[r(y,{type:"heart",size:"14",color:"#868e96"}),r(f,null,{default:o((()=>[n("也可以预习明天的课程")])),_:1})])),_:1}),r(p,{class:"suggestion-item"},{default:o((()=>[r(y,{type:"smile",size:"14",color:"#868e96"}),r(f,null,{default:o((()=>[n("或者好好放松休息")])),_:1})])),_:1})])),_:1})):c("",!0)])),_:1}))])),_:1}),d.loading?(l(),s(p,{key:2,class:"schedule-loading"},{default:o((()=>[r(p,{class:"loading-spinner"}),r(f,{class:"loading-text"},{default:o((()=>[n("正在加载课程数据...")])),_:1})])),_:1})):c("",!0)])),_:1})}}},[["__scopeId","data-v-690e048a"]]),q={baseURL:null,endpoints:{classtable:"/api/v1/classtable"},timeout:1e4},B=e=>{const t={"Content-Type":"application/json"};return e&&(t.Authorization=`Bearer ${e}`),t},P=e=>{if(!e)return null;let t;if(t="string"==typeof e?new Date(e):e,isNaN(t.getTime()))throw new Error("无效的日期格式");return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},G=e=>{const t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return null;const a=t.getDay();let l=new Date(t);0===a?l.setDate(t.getDate()-6):l.setDate(t.getDate()-(a-1));const s=l.getFullYear(),o=new Date(s,0,1).getDay(),r=new Date(s,0,1+(1===o?0:8-o));if(l<r)return G(new Date(s-1,11,31));const n=Math.floor((l-r)/6048e5)+1;return`${s}-${String(n).padStart(2,"0")}`},O=(e,t)=>{const a=G(e),l=G(t);return a===l&&null!==a&&null!==l},J=()=>[{period:1,name:"第一大节",time:"08:00-09:40",slots:[1,2]},{period:2,name:"第二大节",time:"10:00-11:40",slots:[3,4]},{period:3,name:"第三大节",time:"14:00-15:40",slots:[5,6]},{period:4,name:"第四大节",time:"16:00-17:40",slots:[7,8]},{period:5,name:"第五大节",time:"19:00-20:40",slots:[9,10]}],W=()=>[{id:1,name:"星期一",short:"周一"},{id:2,name:"星期二",short:"周二"},{id:3,name:"星期三",short:"周三"},{id:4,name:"星期四",short:"周四"},{id:5,name:"星期五",short:"周五"},{id:6,name:"星期六",short:"周六"},{id:7,name:"星期日",short:"周日"}],Z=async(e=null)=>{try{let t=null;if(e){if(!(e=>{if(!e)return!0;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const t=new Date(e);return t instanceof Date&&!isNaN(t.getTime())})(e))throw new Error("日期格式错误，请使用 YYYY-MM-DD 格式");t=P(e)}const a=b("token");if(!a)throw new Error("用户未登录");let l=`${q.baseURL||(q.baseURL=C().globalData.apiBaseURL),q.baseURL}${q.endpoints.classtable}`;t&&(l+=`?date=${t}`),console.log(`正在请求课程表数据: ${l}`);const s=await h({url:l,method:"GET",header:B(a),timeout:q.timeout}),{statusCode:o,data:r}=s;if(200===o){if(r.success||200===r.code)return console.log("课程表数据获取成功"),(e=>{var t;if(!e||!e.data)throw new Error("课程表数据格式错误");const{data:a}=e;a.courses&&Array.isArray(a.courses)||(console.warn("课程数据格式异常，使用空数组"),a.courses=[]),a.time_slots&&Array.isArray(a.time_slots)||(console.warn("时间段数据格式异常，使用默认配置"),a.time_slots=J()),a.weekdays&&Array.isArray(a.weekdays)||(console.warn("星期数据格式异常，使用默认配置"),a.weekdays=W());const l=a.courses.map((e=>(e.id||(e.id=`course_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),e.time_info&&(0===e.time_info.weekday&&(e.time_info.weekday=7),e.time_info.is_cross_period&&e.time_info.actual_periods?(e.time_info.display_periods=e.time_info.actual_periods,e.time_info.period_count=e.time_info.actual_periods.length):(e.time_info.display_periods=e.time_info.time_slots||[],e.time_info.period_count=e.time_info.display_periods.length)),e.style||(e.style={color:"#7f4515",row:1,col:1,row_span:1,col_span:1}),e))),s={total_courses:l.length,total_hours:l.reduce(((e,t)=>{var a;return e+((null==(a=t.time_info)?void 0:a.period_count)||0)}),0),courses_by_day:(null==(t=a.stats)?void 0:t.courses_by_day)||{}};return{...a,courses:l,stats:s,processed_at:(new Date).toISOString()}})(r);throw new Error(r.detail||r.message||"获取课程表失败")}{const e=((e,t,a="获取课程表")=>{let l=`${a}失败`;switch(e){case 400:l=t.detail||t.message||"请求参数错误";break;case 401:l="登录已过期，请重新登录",$("token"),setTimeout((()=>{S({url:"/pages/index/index"})}),1500);break;case 403:l="没有权限访问";break;case 404:l="服务不存在";break;case 422:l="请求数据格式错误";break;case 429:l="请求过于频繁，请稍后再试";break;case 500:l="服务器内部错误，请重新登录",$("token"),setTimeout((()=>{S({url:"/pages/index/index"})}),1500);break;case 502:case 503:case 504:l="服务暂时不可用，请稍后重试";break;default:l=t.detail||t.message||`${a}失败`}return{message:l,shouldRetry:[502,503,504,429].includes(e)}})(o,r,"获取课程表");throw new Error(e.message)}}catch(t){if(console.error("获取课程表失败:",t),t.errMsg){if(t.errMsg.includes("timeout"))throw new Error("请求超时，请检查网络连接");if(t.errMsg.includes("fail"))throw new Error("网络连接失败，请检查网络设置")}throw t}},K="classtable_week_cache",Q=18e5,V=e=>{try{const t=b(K);return t?Date.now()-t.timestamp>Q?(console.log("课程表缓存已过期"),null):t.weekId&&O(e,t.requestDate)?(console.log(`使用缓存的课程表数据，周标识: ${t.weekId}`),t.data):(console.log("请求日期不在缓存周内，需要重新获取"),null):null}catch(t){return console.warn("读取课程表缓存失败:",t),null}},X=I({__name:"classtable",setup(i){const d=e(!0),v=e(null),g=e(""),w=e(B(new Date)),k=e(null),h=e(!1),C=e(!1),$=e(null);function I(e){if(!e)return new Date;const t=e.split("-");return 3!==t.length?new Date:new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]))}function U(e){return["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][e.getDay()]}t((()=>!!v.value));const q=t((()=>{const e=I(w.value);return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),weekDay:U(e)}}));function B(e){if("string"==typeof e)return e;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function J(){return!!b("token")||(x({title:"请先登录",icon:"none"}),S({url:"/pages/index/index"}),!1)}async function W(e=!0,t=!1){e&&(d.value=!0),g.value="";try{let a=t;if(!t){const t=V(w.value);if(t)return console.log(`使用缓存数据，日期: ${w.value}`),v.value=t,$.value=w.value,void(e&&(d.value=!1));if($.value&&O(w.value,$.value)&&(console.log(`在同一周内切换日期，不需要重新请求: ${w.value}`),v.value))return void(e&&(d.value=!1));a=!0}if(a){console.log(`从API获取课程表数据: ${w.value}`);const e=await Z(w.value);v.value=e,$.value=w.value,((e,t)=>{try{const a=G(e);if(!a)return void console.warn("无法获取日期的周标识，跳过缓存");const l={data:t,weekId:a,requestDate:P(e),timestamp:Date.now()};D(K,l),console.log(`课程表数据已缓存，周标识: ${a}, 请求日期: ${l.requestDate}`)}catch(g){console.warn("缓存课程表数据失败:",g)}})(w.value,e),console.log("课程表数据加载成功",e)}}catch(a){console.error("获取课程表失败",a),g.value=a.message||"获取课程表失败";const t=V(w.value);t?(v.value=t,$.value=w.value,x({title:"网络错误，已显示缓存数据",icon:"none",duration:2e3})):(v.value=null,e&&x({title:g.value,icon:"none"}))}finally{e&&(d.value=!1)}}function Q(){W(!0,!0)}function X(){const e=I(w.value);e.setDate(e.getDate()-1),w.value=B(e),W()}function ee(){const e=I(w.value);e.setDate(e.getDate()+1),w.value=B(e),W()}function te(e){console.log("课程点击:",e),k.value=e.course,setTimeout((()=>{h.value=!0}),10)}function ae(){h.value=!1,setTimeout((()=>{k.value=null}),300)}return A((()=>{J()&&(T({title:"课程表"}),W())})),L((()=>{if(!J())return;const e=B(new Date);if(w.value===e&&v.value){const e=v.value.processed_at;e&&Date.now()-new Date(e).getTime()>3e5&&W(!1)}})),p((()=>{})),y((()=>{})),(e,t)=>{const i=_,p=m,y=E(a("uni-icons"),N),b=M;return l(),s(j,null,{default:o((()=>[d.value?(l(),s(F,{key:0,text:"正在加载课程表数据..."})):(l(),s(i,{key:1,class:"page-container page-rounded-container"},{default:o((()=>[r(i,{class:"background-decoration"},{default:o((()=>[r(i,{class:"circle circle-1"}),r(i,{class:"circle circle-2"}),r(i,{class:"circle circle-3"})])),_:1}),r(i,{class:"page-header"},{default:o((()=>[r(i,{class:"header-content"},{default:o((()=>[r(p,{class:"page-title"},{default:o((()=>[n("课程表")])),_:1}),r(p,{class:"page-subtitle"},{default:o((()=>[n("Class Schedule")])),_:1})])),_:1})])),_:1}),r(i,{class:"content-wrapper"},{default:o((()=>{var e,t,a;return[r(i,{class:"simple-date-nav"},{default:o((()=>[r(b,{class:"nav-btn",onClick:X},{default:o((()=>[r(y,{type:"left",size:"20",color:"#495057"})])),_:1}),r(i,{class:"date-info"},{default:o((()=>[r(i,{class:"main-date"},{default:o((()=>[n(u(q.value.month)+"月"+u(q.value.day)+"日",1)])),_:1}),r(i,{class:"sub-date"},{default:o((()=>[n(u(q.value.weekDay)+" • "+u(q.value.year),1)])),_:1})])),_:1}),r(b,{class:"nav-btn",onClick:ee},{default:o((()=>[r(y,{type:"right",size:"20",color:"#495057"})])),_:1})])),_:1}),g.value&&!v.value?(l(),s(R,{key:0,"icon-type":"wifi-off",title:"加载失败",description:g.value,"show-retry":!0,onRetry:Q},null,8,["description"])):(l(),s(H,{key:1,"selected-date":w.value,courses:(null==(e=v.value)?void 0:e.courses)||[],"time-slots":(null==(t=v.value)?void 0:t.time_slots)||[],loading:d.value,onCourseClick:te},null,8,["selected-date","courses","time-slots","loading"])),C.value&&(null==(a=v.value)?void 0:a.stats)?(l(),s(Y,{key:2,title:"本周统计",class:"stats-card"},{default:o((()=>[r(i,{class:"stats-grid"},{default:o((()=>[r(i,{class:"stat-item"},{default:o((()=>[r(p,{class:"stat-value"},{default:o((()=>[n(u(v.value.stats.total_courses),1)])),_:1}),r(p,{class:"stat-label"},{default:o((()=>[n("总课程数")])),_:1})])),_:1}),r(i,{class:"stat-item"},{default:o((()=>[r(p,{class:"stat-value"},{default:o((()=>[n(u(v.value.stats.total_hours),1)])),_:1}),r(p,{class:"stat-label"},{default:o((()=>[n("总学时")])),_:1})])),_:1})])),_:1})])),_:1})):c("",!0)]})),_:1})])),_:1})),k.value?(l(),s(i,{key:2,class:f(["course-detail-modal",{show:h.value}]),onClick:ae},{default:o((()=>[r(i,{class:f(["modal-content",{show:h.value}]),onClick:t[0]||(t[0]=z((()=>{}),["stop"]))},{default:o((()=>[r(i,{class:"modal-header"},{default:o((()=>[r(p,{class:"modal-title"},{default:o((()=>[n(u(k.value.name),1)])),_:1}),r(b,{class:"modal-close",onClick:ae},{default:o((()=>[r(y,{type:"closeempty",size:"20",color:"#6c757d"})])),_:1})])),_:1}),r(i,{class:"modal-body"},{default:o((()=>[r(i,{class:"detail-section"},{default:o((()=>[r(i,{class:"section-title"},{default:o((()=>[n("课程信息")])),_:1}),r(i,{class:"detail-row"},{default:o((()=>[r(p,{class:"label"},{default:o((()=>[n("上课地点：")])),_:1}),r(p,{class:"value"},{default:o((()=>[n(u(k.value.location),1)])),_:1})])),_:1}),r(i,{class:"detail-row"},{default:o((()=>[r(p,{class:"label"},{default:o((()=>[n("课程类型：")])),_:1}),r(p,{class:"value"},{default:o((()=>[n(u(k.value.course_type),1)])),_:1})])),_:1}),r(i,{class:"detail-row"},{default:o((()=>[r(p,{class:"label"},{default:o((()=>[n("学分：")])),_:1}),r(p,{class:"value"},{default:o((()=>[n(u(k.value.credits),1)])),_:1})])),_:1}),k.value.class_name?(l(),s(i,{key:0,class:"detail-row"},{default:o((()=>[r(p,{class:"label"},{default:o((()=>[n("上课班级：")])),_:1}),r(p,{class:"value"},{default:o((()=>[n(u(k.value.class_name),1)])),_:1})])),_:1})):c("",!0)])),_:1}),k.value.time_info?(l(),s(i,{key:0,class:"detail-section"},{default:o((()=>[r(i,{class:"section-title"},{default:o((()=>[n("时间安排")])),_:1}),r(i,{class:"detail-row"},{default:o((()=>[r(p,{class:"label"},{default:o((()=>[n("上课时间：")])),_:1}),r(p,{class:"value"},{default:o((()=>[n(u(k.value.time_info.weekday_name)+" "+u(k.value.time_info.period_name),1)])),_:1})])),_:1}),r(i,{class:"detail-row"},{default:o((()=>[r(p,{class:"label"},{default:o((()=>[n("具体时段：")])),_:1}),r(p,{class:"value"},{default:o((()=>[n(u(k.value.time_info.start_time)+" - "+u(k.value.time_info.end_time),1)])),_:1})])),_:1}),k.value.time_info.is_cross_period?(l(),s(i,{key:0,class:"detail-row"},{default:o((()=>[r(p,{class:"label"},{default:o((()=>[n("实际节次：")])),_:1}),r(p,{class:"value"},{default:o((()=>{var e;return[n("第"+u((null==(e=k.value.time_info.actual_periods)?void 0:e.join("、"))||"未知")+"节 (跨大节课程)",1)]})),_:1})])),_:1})):c("",!0),r(i,{class:"detail-row"},{default:o((()=>[r(p,{class:"label"},{default:o((()=>[n("上课周次：")])),_:1}),r(p,{class:"value"},{default:o((()=>{var e;return[n("第"+u((null==(e=k.value.weeks)?void 0:e.join("、"))||"未知")+"周",1)]})),_:1})])),_:1})])),_:1})):c("",!0)])),_:1}),r(i,{class:"modal-footer"},{default:o((()=>[r(b,{class:"modal-btn",onClick:ae},{default:o((()=>[n("确定")])),_:1})])),_:1})])),_:1},8,["class"])])),_:1},8,["class"])):c("",!0)])),_:1})}}},[["__scopeId","data-v-91f59bd1"]]);export{X as default};

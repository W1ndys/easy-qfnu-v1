import{r as e,o as s,c as t,w as a,a as l,b as r,d as i,i as o,e as c,f as n,h as u,t as d,k as f,p,A as m,m as h,N as _,F as y,a4 as g,u as k,H as b,R as q}from"./index-DNZRe5Ot.js";import{r as C,_ as R}from"./uni-icons.Jp--qL9q.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const v=x({components:{DisclaimerCard:x({name:"DisclaimerCard"},[["render",function(c,n,u,d,f,p){const m=C(e("uni-icons"),R),h=i,_=o;return s(),t(h,{class:"disclaimer-card modern-card"},{default:a((()=>[l(h,{class:"disclaimer-header"},{default:a((()=>[l(h,{class:"disclaimer-icon"},{default:a((()=>[l(m,{type:"info-filled",size:"24",color:"#ff6b35"})])),_:1}),l(_,{class:"disclaimer-title"},{default:a((()=>[r("重要声明")])),_:1})])),_:1}),l(h,{class:"disclaimer-content"},{default:a((()=>[l(_,{class:"disclaimer-text"},{default:a((()=>[r(" 本题库由新生手册根据大模型生成，仅供参考。使用前请确保您已充分阅读并学习曲阜师范大学新生手册内容并遵守相关规定。使用本程序造成的一切后果与本程序无关，使用本程序即代表您同意上方声明内容。 ")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-3598ef9c"]]),GroupInfoCard:x({name:"GroupInfoCard",methods:{copyGroupNumber(){c({data:"1046961227",success:()=>{n({title:"群号已复制",icon:"success",duration:2e3})},fail:()=>{n({title:"复制失败",icon:"none",duration:2e3})}})}}},[["render",function(c,n,u,d,f,p){const m=C(e("uni-icons"),R),h=i,_=o;return s(),t(h,{class:"group-info-card modern-card"},{default:a((()=>[l(h,{class:"group-header"},{default:a((()=>[l(h,{class:"group-icon"},{default:a((()=>[l(m,{type:"chat-filled",size:"24",color:"#1890ff"})])),_:1}),l(_,{class:"group-title"},{default:a((()=>[r("学习交流群")])),_:1})])),_:1}),l(h,{class:"group-content"},{default:a((()=>[l(_,{class:"group-description"},{default:a((()=>[r("曲师大25级选课学习交流群")])),_:1}),l(h,{class:"group-number",onClick:p.copyGroupNumber},{default:a((()=>[l(_,{class:"group-label"},{default:a((()=>[r("群号：")])),_:1}),l(_,{class:"group-id"},{default:a((()=>[r("1046961227")])),_:1}),l(h,{class:"copy-icon"},{default:a((()=>[l(m,{type:"copy",size:"16",color:"#1890ff"})])),_:1})])),_:1},8,["onClick"]),l(_,{class:"group-hint"},{default:a((()=>[r("点击群号可复制")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-f71e0f66"]]),SearchCard:x({name:"SearchCard",props:{loading:{type:Boolean,default:!1}},data:()=>({searchForm:{question:""},questionError:!1,questionFocused:!1}),computed:{questionHint(){const e=this.searchForm.question.trim().length;return 0===e?"请输入题目内容或关键词":e<2?`至少需要2个字符，当前${e}个字符`:`已输入${e}个字符`},canSearch(){return this.searchForm.question.trim().length>=2}},methods:{validateQuestion(){const e=this.searchForm.question.trim().length;this.questionError=e>0&&e<2},handleSearch(){this.searchForm.question.trim()?this.searchForm.question.trim().length<2?n({title:"题目内容至少需要2个字符",icon:"none"}):this.$emit("search",{query:this.searchForm.question.trim()}):n({title:"请输入题目内容",icon:"none"})},handleReset(){this.searchForm={question:""},this.questionError=!1,this.$emit("reset")}}},[["render",function(c,n,h,_,y,g){const k=C(e("uni-icons"),R),b=i,q=o,x=p,v=m;return s(),t(b,{class:"search-card modern-card"},{default:a((()=>[l(b,{class:"card-header"},{default:a((()=>[l(b,{class:"header-icon"},{default:a((()=>[l(k,{type:"search",size:"24",color:"#7f4515"})])),_:1}),l(b,{class:"header-text"},{default:a((()=>[l(q,{class:"card-title"},{default:a((()=>[r("智能搜索")])),_:1}),l(q,{class:"card-subtitle"},{default:a((()=>[r("输入题目关键词进行语义搜索")])),_:1})])),_:1})])),_:1}),l(b,{class:"form-content"},{default:a((()=>[l(b,{class:"form-group"},{default:a((()=>[l(b,{class:"input-label"},{default:a((()=>[l(k,{type:"help",size:"20",color:"#495057"}),l(q,null,{default:a((()=>[r("题目内容")])),_:1})])),_:1}),l(b,{class:"input-wrapper"},{default:a((()=>[l(x,{class:u(["modern-textarea",{"input-error":y.questionError,"input-focus":y.questionFocused}]),modelValue:y.searchForm.question,"onUpdate:modelValue":n[0]||(n[0]=e=>y.searchForm.question=e),placeholder:"请输入题目关键词或完整题目","auto-height":"",onInput:g.validateQuestion,onFocus:n[1]||(n[1]=e=>y.questionFocused=!0),onBlur:n[2]||(n[2]=e=>y.questionFocused=!1)},null,8,["class","modelValue","onInput"]),l(b,{class:u(["input-line",{active:y.questionFocused}])},null,8,["class"])])),_:1}),l(q,{class:u(["input-hint",{"hint-error":y.questionError}])},{default:a((()=>[r(d(g.questionHint),1)])),_:1},8,["class"])])),_:1}),l(b,{class:"button-group"},{default:a((()=>[l(v,{class:"action-btn primary-btn",onClick:g.handleSearch,loading:h.loading,disabled:!g.canSearch},{default:a((()=>[h.loading?f("",!0):(s(),t(k,{key:0,type:"search",size:"20",color:"#ffffff"})),l(q,null,{default:a((()=>[r(d(h.loading?"搜索中...":"开始搜索"),1)])),_:1})])),_:1},8,["onClick","loading","disabled"]),l(v,{class:"action-btn secondary-btn",onClick:g.handleReset},{default:a((()=>[l(k,{type:"refresh",size:"20",color:"#495057"}),l(q,null,{default:a((()=>[r("重置")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-dd9e29bb"]]),QuestionCard:x({name:"QuestionCard",props:{result:{type:Object,required:!0},index:{type:Number,required:!0}},methods:{formatOptions:e=>e&&"object"==typeof e?Object.keys(e).map((s=>({key:s,value:e[s]}))).sort(((e,s)=>e.key.localeCompare(s.key))):[]}},[["render",function(c,n,p,m,g,k){const b=C(e("uni-icons"),R),q=i,x=o;return s(),t(q,{class:"question-card modern-card"},{default:a((()=>[l(q,{class:"question-header"},{default:a((()=>[l(q,{class:"question-info"},{default:a((()=>[l(q,{class:"question-icon"},{default:a((()=>[l(b,{type:"help-filled",size:"20",color:"#7f4515"})])),_:1}),l(x,{class:"question-number"},{default:a((()=>[r("题目 "+d(p.index+1),1)])),_:1}),p.result.type?(s(),t(q,{key:0,class:"type-badge"},{default:a((()=>[l(x,{class:"type-text"},{default:a((()=>[r(d(p.result.type),1)])),_:1})])),_:1})):f("",!0),l(q,{class:"similarity-badge"},{default:a((()=>[l(x,{class:"similarity-text"},{default:a((()=>[r("相似度: "+d((100*p.result.score).toFixed(1))+"%",1)])),_:1})])),_:1})])),_:1})])),_:1}),l(q,{class:"question-content"},{default:a((()=>[l(q,{class:"question-text-section"},{default:a((()=>[l(x,{class:"question-text"},{default:a((()=>[r(d(p.result.question),1)])),_:1})])),_:1}),p.result.options?(s(),t(q,{key:0,class:"options-section"},{default:a((()=>[l(q,{class:"options-list"},{default:a((()=>[(s(!0),h(y,null,_(k.formatOptions(p.result.options),(e=>(s(),t(q,{class:u(["option-item",{"correct-option":p.result.answer&&e.key===p.result.answer.letter}]),key:e.key},{default:a((()=>[l(x,{class:"option-label"},{default:a((()=>[r(d(e.key)+".",1)])),_:2},1024),l(x,{class:"option-text"},{default:a((()=>[r(d(e.value),1)])),_:2},1024),p.result.answer&&e.key===p.result.answer.letter?(s(),t(q,{key:0,class:"correct-mark"},{default:a((()=>[l(b,{type:"checkmarkempty",size:"16",color:"#52c41a"})])),_:1})):f("",!0)])),_:2},1032,["class"])))),128))])),_:1})])),_:1})):f("",!0),p.result.category||p.result.difficulty||p.result.type?(s(),t(q,{key:1,class:"question-meta"},{default:a((()=>[p.result.type?(s(),t(q,{key:0,class:"meta-item"},{default:a((()=>[l(x,{class:"meta-label"},{default:a((()=>[r("类型")])),_:1}),l(x,{class:"meta-value"},{default:a((()=>[r(d(p.result.type),1)])),_:1})])),_:1})):f("",!0),p.result.category?(s(),t(q,{key:1,class:"meta-item"},{default:a((()=>[l(x,{class:"meta-label"},{default:a((()=>[r("分类")])),_:1}),l(x,{class:"meta-value"},{default:a((()=>[r(d(p.result.category),1)])),_:1})])),_:1})):f("",!0),p.result.difficulty?(s(),t(q,{key:2,class:"meta-item"},{default:a((()=>[l(x,{class:"meta-label"},{default:a((()=>[r("难度")])),_:1}),l(x,{class:"meta-value"},{default:a((()=>[r(d(p.result.difficulty),1)])),_:1})])),_:1})):f("",!0)])),_:1})):f("",!0)])),_:1})])),_:1})}],["__scopeId","data-v-fd0eba0a"]]),StateCards:x({name:"StateCards",props:{type:{type:String,required:!0,validator:e=>["empty","initial","loading"].includes(e)},emptyMessage:{type:String,default:"未找到相关题目，请尝试其他关键词"}},methods:{handleRetry(){this.$emit("retry")}}},[["render",function(c,n,u,p,h,_){const y=C(e("uni-icons"),R),g=i,k=o,b=m;return"empty"===u.type?(s(),t(g,{key:0,class:"empty-state modern-card"},{default:a((()=>[l(g,{class:"empty-content"},{default:a((()=>[l(g,{class:"empty-icon"},{default:a((()=>[l(y,{type:"info",size:"80",color:"#adb5bd"})])),_:1}),l(k,{class:"empty-title"},{default:a((()=>[r("未找到相关题目")])),_:1}),l(k,{class:"empty-subtitle"},{default:a((()=>[r(d(u.emptyMessage),1)])),_:1}),l(b,{class:"action-btn primary-btn retry-btn",onClick:_.handleRetry},{default:a((()=>[l(y,{type:"refresh",size:"20",color:"#ffffff"}),l(k,null,{default:a((()=>[r("重新搜索")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})):"initial"===u.type?(s(),t(g,{key:1,class:"initial-state modern-card"},{default:a((()=>[l(g,{class:"initial-content"},{default:a((()=>[l(g,{class:"initial-icon"},{default:a((()=>[l(y,{type:"help",size:"80",color:"#7f4515"})])),_:1}),l(k,{class:"initial-title"},{default:a((()=>[r("欢迎使用搜索功能")])),_:1}),l(k,{class:"initial-subtitle"},{default:a((()=>[r("输入题目关键词，快速找到相关题目和答案")])),_:1}),l(g,{class:"tips-section"},{default:a((()=>[l(g,{class:"tip-item"},{default:a((()=>[l(y,{type:"checkmarkempty",size:"16",color:"#52c41a"}),l(k,{class:"tip-text"},{default:a((()=>[r("支持关键词搜索")])),_:1})])),_:1}),l(g,{class:"tip-item"},{default:a((()=>[l(y,{type:"checkmarkempty",size:"16",color:"#52c41a"}),l(k,{class:"tip-text"},{default:a((()=>[r("智能语义匹配")])),_:1})])),_:1}),l(g,{class:"tip-item"},{default:a((()=>[l(y,{type:"checkmarkempty",size:"16",color:"#52c41a"}),l(k,{class:"tip-text"},{default:a((()=>[r("精准答案推荐")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):"loading"===u.type?(s(),t(g,{key:2,class:"loading-state modern-card"},{default:a((()=>[l(g,{class:"loading-content"},{default:a((()=>[l(g,{class:"loading-spinner"},{default:a((()=>[l(y,{type:"spinner-cycle",size:"60",color:"#7f4515"})])),_:1}),l(k,{class:"loading-text"},{default:a((()=>[r("正在搜索题目...")])),_:1}),l(k,{class:"loading-subtitle"},{default:a((()=>[r("使用AI语义分析匹配相关内容")])),_:1})])),_:1})])),_:1})):f("",!0)}],["__scopeId","data-v-984e90d9"]])},data:()=>({searchResults:[],loading:!1,searched:!1,emptyMessage:"未找到相关题目"}),computed:{hasResults(){return this.searchResults.length>0}},onLoad(){g({title:"新生入学考试辅助"}),console.log("用户进入新生入学考试辅助页面")},methods:{async handleSearch(e){this.loading=!0,this.searched=!0;try{const s=await this.searchQuestions({query:e.query,topk:3,threshold:.2});s.ok?(this.searchResults=s.results||[],this.hasResults||(this.emptyMessage="未找到相关题目，请尝试其他关键词")):(this.searchResults=[],this.emptyMessage=s.message||"搜索失败",n({title:this.emptyMessage,icon:"none"}))}catch(s){console.error("搜索题目失败:",s),this.searchResults=[];let e="网络错误，请重试";s.message&&(s.message.includes("HTTP 422")?e="输入参数格式错误，请检查输入内容":s.message.includes("HTTP 400")?e="请求参数错误，请检查输入内容":s.message.includes("HTTP 500")?e="服务器内部错误，请稍后重试":s.message.includes("HTTP")&&(e=`请求失败: ${s.message}`)),this.emptyMessage=e,n({title:e,icon:"none",duration:3e3})}finally{this.loading=!1}},handleReset(){this.searchResults=[],this.searched=!1},async searchQuestions(e){const s=k().globalData.apiBaseURL;return new Promise(((t,a)=>{b({url:`${s}/api/v1/question/freshman-question-search`,method:"POST",data:e,header:{"Content-Type":"application/json"},success:e=>{var s;if(200!==e.statusCode)return console.error("API请求失败:",e),void a(new Error(`HTTP ${e.statusCode}: ${(null==(s=e.data)?void 0:s.message)||"请求失败"}`));t(e.data)},fail:e=>{a(e)}})}))}}},[["render",function(e,c,n,u,p,m){const g=i,k=o,b=q("DisclaimerCard"),C=q("GroupInfoCard"),R=q("SearchCard"),x=q("QuestionCard"),v=q("StateCards");return s(),t(g,{class:"page-container page-rounded-container"},{default:a((()=>[l(g,{class:"background-decoration"},{default:a((()=>[l(g,{class:"circle circle-1"}),l(g,{class:"circle circle-2"}),l(g,{class:"circle circle-3"})])),_:1}),l(g,{class:"page-header"},{default:a((()=>[l(g,{class:"header-content"},{default:a((()=>[l(k,{class:"page-title"},{default:a((()=>[r("新生入学考试辅助")])),_:1}),l(k,{class:"page-subtitle"},{default:a((()=>[r("Freshman Examination Q&A")])),_:1})])),_:1})])),_:1}),l(b),l(C),l(g,{class:"content-wrapper"},{default:a((()=>[l(R,{loading:p.loading,onSearch:m.handleSearch,onReset:m.handleReset},null,8,["loading","onSearch","onReset"]),m.hasResults?(s(),t(g,{key:0,class:"results-section"},{default:a((()=>[l(g,{class:"results-header"},{default:a((()=>[l(g,{class:"results-info"},{default:a((()=>[l(k,{class:"results-title"},{default:a((()=>[r("搜索结果")])),_:1}),l(k,{class:"results-count"},{default:a((()=>[r("找到 "+d(p.searchResults.length)+" 个相关题目",1)])),_:1})])),_:1})])),_:1}),(s(!0),h(y,null,_(p.searchResults,((e,a)=>(s(),t(x,{key:a,result:e,index:a},null,8,["result","index"])))),128))])),_:1})):p.searched&&!p.loading?(s(),t(v,{key:1,type:"empty","empty-message":p.emptyMessage,onRetry:m.handleReset},null,8,["empty-message","onRetry"])):p.searched||p.loading?p.loading?(s(),t(v,{key:3,type:"loading"})):f("",!0):(s(),t(v,{key:2,type:"initial"}))])),_:1})])),_:1})}],["__scopeId","data-v-f4a3b290"]]);export{v as default};

import{a1 as e,a2 as r}from"./index-OTnz2_jg.js";function o(o){if("undefined"!=typeof wx&&e)try{const e=r(o),n=new Uint8Array(e);let t="";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t}catch(c){}if("undefined"!=typeof atob)return atob(o);const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let t="",a=0;for(o=o.replace(/[^A-Za-z0-9+/]/g,"");a<o.length;){const e=n.indexOf(o.charAt(a++)),r=n.indexOf(o.charAt(a++)),c=n.indexOf(o.charAt(a++)),s=n.indexOf(o.charAt(a++)),i=e<<18|r<<12|c<<6|s,l=i>>16&255,f=i>>8&255,h=255&i;t+=String.fromCharCode(l),64!==c&&(t+=String.fromCharCode(f)),64!==s&&(t+=String.fromCharCode(h))}return t}function n(e){var r=e.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("Illegal base64url string!")}try{return function(e){try{const r=o(e);return decodeURIComponent(r.replace(/(.)/g,(function(e,r){var o=r.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o})))}catch(r){return o(e)}}(r)}catch(n){return console.warn("Unicode解码失败，尝试直接base64解码:",n),o(r)}}function t(e){if(console.log("开始解析JWT token..."),"string"!=typeof e)throw console.error("Token不是字符串类型:",typeof e),new Error("Invalid token specified");if(!e||""===e.trim())throw console.error("Token为空"),new Error("Token is empty");const r=e.split(".");if(console.log("Token分割结果:",r.length,"个部分"),3!==r.length)throw console.error("JWT格式错误，应该有3个部分，实际有:",r.length),new Error("JWT must have 3 parts");try{const e=n(r[1]);if(console.log("Base64解码成功"),!e)throw console.error("Base64解码结果为空"),new Error("Cannot decode the token.");const o=JSON.parse(e);if(console.log("JWT解析成功，payload:",o),o.exp){const e=Math.floor(Date.now()/1e3);if(o.exp<e)throw console.error("Token已过期，过期时间:",new Date(1e3*o.exp),"当前时间:",new Date),new Error("Token has expired")}return o}catch(o){throw console.error("JWT解析失败:",o),o}}function a(e){try{return t(e),!0}catch(r){return console.log("Token验证失败:",r.message),!1}}export{t as d,a as i};

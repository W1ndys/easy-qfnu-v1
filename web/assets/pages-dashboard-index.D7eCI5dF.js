import{p as e,q as t,s as a,u as s,v as l,r as c,c as n,w as o,l as i,z as u,o as d,a as r,j as f,t as p,f as _,K as m,F as x,L as g,M as k,h as b,N as h,A as y,B as v,D as C,g as q,k as z,J as Q,n as F,d as j,y as w}from"./index-CEuJ3-9a.js";import{_ as T,o as E,b as A,r as B,a as M}from"./uni-app.es.DgoqDfpz.js";import{d as G}from"./jwt-decode.yLM-vOft.js";import{P as L,M as N}from"./ModernCard.Bt8zhi40.js";const U=T({__name:"index",setup(T){const U=e({student_name:"...",student_id:"加载中...",college:"...",major:"...",class_name:"..."}),$=e([{text:"成绩查询",description:"查看成绩与GPA分析",icon:"paperplane",url:"/pages/grades/index"},{text:"平均分查询",description:"查看课程平均分数据",icon:"bars",url:"/pages/average-scores/index"},{text:"选课推荐",description:"智能推荐选课方案",icon:"star",url:"https://doc.easy-qfnu.top/EasySelectCourse/CourseSelectionRecommendation/",external:!0},{text:"培养方案",description:"查看模块完成进度",icon:"list",url:"/pages/course-plan/index"},{text:"预选课查询",description:"夫子校园提供技术支持",icon:"checkmarkempty",url:"http://xk.s.fz.z-xin.net/",external:!0},{text:"课表查询",description:"即将推出",icon:"calendar",url:""},{text:"排名查询",description:"即将推出",icon:"medal",url:""},{text:"更多功能",description:"敬请期待",icon:"gear",url:""}]);E((()=>{I()})),A((()=>{I()}));const D=async()=>{const e=t("token");if(!e)return;const c=i().globalData.apiBaseURL;u({url:`${c}/api/v1/profile`,method:"GET",header:{Authorization:`Bearer ${e}`},success:e=>{200===e.statusCode&&e.data.success?U.value=e.data.data:(a({title:e.data.message||`获取信息失败 (${e.statusCode})`,icon:"none"}),401===e.statusCode&&(l("token"),setTimeout((()=>{s({url:"/pages/index/index"})}),1500)))},fail:e=>{console.error("获取个人信息请求失败",e),a({title:"网络请求失败，请稍后重试",icon:"none"})}})},I=()=>{const e=t("token");if(!e)return a({title:"请先登录",icon:"none"}),void s({url:"/pages/index/index"});try{const t=G(e);U.value.student_id=t.sub,D()}catch(c){return console.error("Token解析失败",c),l("token"),a({title:"凭证无效,请重新登录",icon:"none"}),void s({url:"/pages/index/index"})}},O=()=>{g({title:"正在刷新..."}),D().finally((()=>{k(),a({title:"数据已刷新",icon:"success"})}))},P=()=>{b({title:"确认退出",content:"确定要退出登录吗？",confirmColor:"#7F4515",success:e=>{e.confirm&&(l("token"),a({title:"已退出登录",icon:"success"}),setTimeout((()=>{s({url:"/pages/index/index"})}),1e3))}})},R=()=>{b({title:"清除缓存",content:"确定要清除所有本地缓存数据吗？这将清除除登录凭证外的所有本地数据。",confirmText:"清除",cancelText:"取消",confirmColor:"#ff4d4f",success:e=>{if(e.confirm)try{const e=t("token");h(),e&&y("token",e),a({title:"缓存已清除",icon:"success",duration:2e3})}catch(s){console.error("清除缓存失败:",s),a({title:"清除缓存失败",icon:"error"})}}})},S=()=>{v({data:"1053432087",success:()=>{a({title:"QQ群号已复制到剪贴板，请自行搜索加群",icon:"success"})},fail:e=>{console.error("复制失败:",e),a({title:"复制失败",icon:"none"})}})},J=()=>{v({data:"1057327742",success:()=>{a({title:"开发交流群号已复制到剪贴板，请自行搜索加群",icon:"success"})},fail:e=>{console.error("复制失败:",e),a({title:"复制失败",icon:"none"})}})},K=()=>{H("用户协议","https://cq4hqujcxu3.feishu.cn/docx/EYE6d5ufAoQt5Axx7MFc4XMrnAf")},X=()=>{H("更新日志","https://cq4hqujcxu3.feishu.cn/docx/BO2od7OI8omtmTxGkB0cn305nFl")},Y=()=>{const e="2769731875";b({title:"联系作者",content:"作者QQ号：2769731875\n\n选择操作：",confirmText:"复制QQ号",cancelText:"取消",confirmColor:"#7F4515",success:t=>{t.confirm&&v({data:e,success:()=>{a({title:"QQ号已复制到剪贴板",icon:"success"})}})}})},H=(e,t)=>{window.open(t,"_blank")},V=()=>{a({title:"赞赏码加载失败",icon:"none"})},W=()=>{console.log("赞赏码加载成功")};return(e,t)=>{const s=C,l=q,i=z,u=B(c("uni-icons"),M),g=Q;return d(),n(L,null,{default:o((()=>[r(l,{class:"page-rounded-container"},{default:o((()=>[r(N,{class:"profile-card",highlight:""},{default:o((()=>[r(l,{class:"profile-content"},{default:o((()=>[r(l,{class:"identity-section"},{default:o((()=>[r(l,{class:"avatar-wrapper"},{default:o((()=>[r(s,{class:"avatar",src:"https://pic1.zhimg.com/80/v2-82c1c70c69720aadac79594ea50ed4a7.png",mode:"aspectFit"}),r(l,{class:"status-indicator"})])),_:1}),r(l,{class:"identity-info"},{default:o((()=>[r(i,{class:"welcome-text"},{default:o((()=>[f("欢迎回来~")])),_:1}),r(i,{class:"user-name"},{default:o((()=>[f(p(U.value.student_name),1)])),_:1}),r(i,{class:"user-id"},{default:o((()=>[f(p(U.value.student_id),1)])),_:1})])),_:1})])),_:1}),r(l,{class:"details-section"},{default:o((()=>[r(l,{class:"detail-item"},{default:o((()=>[r(i,{class:"detail-label"},{default:o((()=>[f("学院")])),_:1}),r(i,{class:"detail-value"},{default:o((()=>[f(p(U.value.college),1)])),_:1})])),_:1}),r(l,{class:"detail-item"},{default:o((()=>[r(i,{class:"detail-label"},{default:o((()=>[f("专业")])),_:1}),r(i,{class:"detail-value"},{default:o((()=>[f(p(U.value.major),1)])),_:1})])),_:1}),r(l,{class:"detail-item"},{default:o((()=>[r(i,{class:"detail-label"},{default:o((()=>[f("班级")])),_:1}),r(i,{class:"detail-value"},{default:o((()=>[f(p(U.value.class_name),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),r(N,{class:"announcement-card"},{default:o((()=>[r(l,{class:"announcement-header"},{default:o((()=>[r(u,{type:"sound",size:"16",color:"#1890ff"}),r(i,{class:"announcement-title"},{default:o((()=>[f("公告栏")])),_:1})])),_:1}),r(i,{class:"announcement-text"},{default:o((()=>[f("该程序正在测试阶段，功能可能不稳定")])),_:1}),r(i,{class:"announcement-text"},{default:o((()=>[f("加入QQ群获取最新消息："),r(i,{class:"qq-link",onClick:S},{default:o((()=>[f("1053432087")])),_:1})])),_:1}),r(i,{class:"announcement-text"},{default:o((()=>[f("如有对Easy-QFNU（曲奇教务）有建议意见或开发想法或其他相关内容的欢迎添加Easy-QFNU开发策划交流群："),r(i,{class:"qq-link",onClick:J},{default:o((()=>[f("1057327742")])),_:1})])),_:1})])),_:1}),r(N,{class:"grid-card"},{default:o((()=>[r(l,{class:"grid-title"},{default:o((()=>[f("核心功能")])),_:1}),r(l,{class:"grid-2x2"},{default:o((()=>[(d(!0),_(x,null,m($.value,((e,t)=>(d(),n(l,{key:t,class:F(["grid-cell",{disabled:!e.url}]),onClick:e=>(e=>{const t=$.value[e];t.url?t.external?window.open(t.url,"_blank"):w({url:t.url}):a({title:"功能正在开发中...",icon:"none"})})(t)},{default:o((()=>[r(l,{class:"cell-icon"},{default:o((()=>[r(u,{type:e.icon,size:"30",color:e.url?"#7F4515":"#C0C6CF"},null,8,["type","color"])])),_:2},1024),r(i,{class:"cell-title"},{default:o((()=>[f(p(e.text),1)])),_:2},1024),e.description?(d(),n(i,{key:0,class:"cell-desc"},{default:o((()=>[f(p(e.description),1)])),_:2},1024)):j("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),r(N,{title:"快捷操作"},{default:o((()=>[r(l,{class:"quick-actions"},{default:o((()=>[r(g,{class:"action-btn refresh-btn",onClick:O},{default:o((()=>[r(u,{type:"refresh",size:"20",color:"#ffffff"}),r(i,null,{default:o((()=>[f("刷新数据")])),_:1})])),_:1}),r(g,{class:"action-btn logout-btn",onClick:P},{default:o((()=>[r(u,{type:"closeempty",size:"20",color:"#ffffff"}),r(i,null,{default:o((()=>[f("退出登录")])),_:1})])),_:1}),r(g,{class:"action-btn clear-cache-btn",onClick:R},{default:o((()=>[r(u,{type:"trash",size:"20",color:"#ffffff"}),r(i,null,{default:o((()=>[f("清除缓存")])),_:1})])),_:1}),r(g,{class:"action-btn agreement-btn",onClick:K},{default:o((()=>[r(u,{type:"paperplane",size:"20",color:"#ffffff"}),r(i,null,{default:o((()=>[f("用户协议")])),_:1})])),_:1}),r(g,{class:"action-btn changelog-btn",onClick:X},{default:o((()=>[r(u,{type:"list",size:"20",color:"#ffffff"}),r(i,null,{default:o((()=>[f("更新日志")])),_:1})])),_:1}),r(g,{class:"action-btn contact-btn",onClick:Y},{default:o((()=>[r(u,{type:"chatbubble",size:"20",color:"#ffffff"}),r(i,null,{default:o((()=>[f("联系作者")])),_:1})])),_:1})])),_:1})])),_:1}),r(N,{title:"支持开发",class:"support-card"},{default:o((()=>[r(l,{class:"support-content"},{default:o((()=>[r(l,{class:"support-text"},{default:o((()=>[r(i,{class:"support-title"},{default:o((()=>[f("助力项目发展")])),_:1}),r(i,{class:"support-desc"},{default:o((()=>[f("本服务完全免费试用，服务器每日支出约为7元左右，以及前期服务器设备等支出几百依赖作者个人支出。如果想支持作者助力开发维护，欢迎赞赏~")])),_:1})])),_:1}),r(l,{class:"qr-code-container"},{default:o((()=>[r(s,{class:"qr-code",src:"https://picx.zhimg.com/80/v2-076422270c197b0031c609e47be2e36c_720w.png?source=d16d100b",mode:"aspectFit",onError:V,onLoad:W}),r(i,{class:"qr-code-label"},{default:o((()=>[f("微信赞赏")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-7c5ffe95"]]);export{U as default};
